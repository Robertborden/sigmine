<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SigMine Login Test</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-white p-8">
  <div class="max-w-2xl mx-auto">
    <h1 class="text-3xl font-bold mb-6">üîß SigMine Login Test</h1>
    
    <div class="bg-gray-800 p-6 rounded-lg mb-4">
      <label class="block mb-2 font-semibold">API Key:</label>
      <input 
        type="text" 
        id="apiKey" 
        class="w-full p-3 bg-gray-700 rounded border border-gray-600 font-mono text-sm"
        placeholder="sig_..."
      />
      <button 
        onclick="testLogin()" 
        class="mt-4 w-full bg-blue-600 hover:bg-blue-700 p-3 rounded font-bold"
      >
        Test Login
      </button>
    </div>

    <div id="result" class="bg-gray-800 p-6 rounded-lg">
      <h2 class="font-bold mb-2">Result:</h2>
      <pre id="output" class="text-sm overflow-auto">Click "Test Login" to start...</pre>
    </div>

    <div class="mt-4 text-sm text-gray-400">
      <p>Backend: <span class="text-green-400">https://sigmine-backend-production.up.railway.app</span></p>
      <p class="mt-2">This page tests the login directly without any caching or complex frontend logic.</p>
    </div>
  </div>

  <script>
    async function testLogin() {
      const apiKey = document.getElementById('apiKey').value.trim();
      const output = document.getElementById('output');
      
      output.textContent = '‚è≥ Testing API key...\n\n';
      
      if (!apiKey) {
        output.textContent = '‚ùå Please enter an API key';
        return;
      }
      
      if (!apiKey.startsWith('sig_')) {
        output.textContent = '‚ö†Ô∏è Warning: API key should start with "sig_"\n\n';
      }
      
      try {
        output.textContent += 'Calling: https://sigmine-backend-production.up.railway.app/agent/me\n';
        output.textContent += 'Headers: X-API-Key: ' + apiKey.substring(0, 20) + '...\n\n';
        
        const response = await fetch('https://sigmine-backend-production.up.railway.app/agent/me', {
          method: 'GET',
          headers: {
            'X-API-Key': apiKey
          }
        });
        
        output.textContent += 'Response Status: ' + response.status + ' ' + response.statusText + '\n\n';
        
        const data = await response.json();
        
        if (response.ok) {
          output.textContent += '‚úÖ SUCCESS!\n\n';
          output.textContent += JSON.stringify(data, null, 2);
          output.textContent += '\n\nüéâ API key is VALID and working!';
        } else {
          output.textContent += '‚ùå FAILED!\n\n';
          output.textContent += JSON.stringify(data, null, 2);
        }
      } catch (error) {
        output.textContent += '‚ùå ERROR!\n\n';
        output.textContent += error.toString();
      }
    }
  </script>
</body>
</html>
